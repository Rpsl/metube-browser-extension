'use strict';

chrome.runtime.onInstalled.addListener(function() {
    // https://stackoverflow.com/questions/19377262/regex-for-youtube-url
    chrome.contextMenus.create({
        id: 'metube',
        title: "Send to MeTube",
        targetUrlPatterns: [
            'http://ab.co/*',
            'http://www.abc.net.au/*',
            'https://iview.abc.net.au/*',
            'http://iview.abc.net.au/*',
            'https://abcnews.go.com/*',
            'http://abcnews.go.com/*',
            'http://abc7news.com/*',
            'https://6abc.com/*',
            'https://api.abcotvs.com/*',
            'https://clips.abcotvs.com/*',
            'http://academicearth.org/*',
            'https://feeder.acast.com/*',
            'http://embed.acast.com/*',
            'https://play.acast.com/*',
            'https://www.acast.com/*',
            'http://play.acast.com/*',
            'https://gw.api.animedigitalnetwork.fr/*',
            'https://animedigitalnetwork.fr/*',
            'http://animedigitalnetwork.fr/*',
            'https://sp.auth.adobe.com/*',
            'https://s3.amazonaws.com/*',
            'https://tv.adobe.com/*',
            'http://tv.adobe.com/*',
            'https://helpx.adobe.com/*',
            'https://video.tv.adobe.com/*',
            'http://www.adultswim.com/*',
            'https://d2gg02c3xr550i.cloudfront.net/*',
            'https://www.adultswim.com/*',
            'http://adultswim.com/*',
            'https://feeds.video.aetnd.com/*',
            'http://www.aetv.com/*',
            'http://www.fyi.tv/*',
            'http://www.mylifetime.com/*',
            'https://watch.lifetimemovieclub.com/*',
            'https://www.aetv.com/*',
            'https://play.aetv.com/*',
            'https://yoga.appsvcs.aetnd.com/*',
            'https://watch.historyvault.com/*',
            'https://www.historyvault.com/*',
            'https://www.history.com/*',
            'http://www.history.com/*',
            'https://www.biography.com/*',
            'http://live.afreecatv.com:8079/*',
            'http://www.afreecatv.com/*',
            'http://vod.afreecatv.com/*',
            'https://login.afreecatv.com/*',
            'https://member.afreecatv.com/*',
            'http://afbbs.afreecatv.com:8080/*',
            'https://air.mozilla.org/*',
            'https://vid.ly/*',
            'https://live.aliexpress.com/*',
            'https://www.aljazeera.com/*',
            'http://www.allocine.fr/*',
            'http://www.alphaporno.com/*',
            'https://amara.org/*',
            'https://www.bbcamerica.com/*',
            'http://www.amc.com/*',
            'http://www.ifc.com/*',
            'http://www.bbcamerica.com/*',
            'http://www.wetv.com/*',
            'https://www.sundancetv.com/*',
            'https://content-delivery-gw.svc.ds.amcn.com/*',
            'https://link.theplatform.com/*',
            'https://www.cooksillustrated.com/*',
            'https://player.zype.com/*',
            'https://www.americastestkitchen.com/*',
            'https://www.cookscountry.com/*',
            'https://y1fnzxui30-dsn.algolia.net/*',
            'https://www.anime-on-demand.de/*',
            'https://www.boston25news.com/*',
            'https://sanfrancisco.cbslocal.com/*',
            'https://www.aol.ca/*',
            'https://www.aol.co.uk/*',
            'https://www.aol.de/*',
            'https://www.aol.jp/*',
            'https://www.aol.com/*',
            'https://feedapi.b2c.on.aol.com/*',
            'http://uvp.apa.at/*',
            'https://uvp-apapublisher.sf.apa.at/*',
            'http://uvp-rma.sf.apa.at/*',
            'http://uvp-kleinezeitung.sf.apa.at/*',
            'https://www.aparat.com/*',
            'http://www.aparat.com/*',
            'https://itunes.apple.com/*',
            'https://podcasts.apple.com/*',
            'http://movietrailers.apple.com/*',
            'http://trailers.apple.com/*',
            'https://archive.org/*',
            'https://www.adn.com/*',
            'https://www.actionnewsjax.com/*',
            'https://elcomercio.pe/*',
            'https://www.clickondetroit.com/*',
            'https://www.wabi.tv/*',
            'https://www.lateja.cr/*',
            'https://www.fifthdomain.com/*',
            'https://www.vl.no/*',
            'https://www.14news.com/*',
            'https://www.theglobeandmail.com/*',
            'https://www.pilotonline.com/*',
            'https://arcpublishing.atlassian.net/*',
            'https://one.ard.de/*',
            'http://mediathek.daserste.de/*',
            'http://mediathek.rbb-online.de/*',
            'https://classic.ardmediathek.de/*',
            'http://www.ardmediathek.de/*',
            'http://www.daserste.de/*',
            'https://www.daserste.de/*',
            'https://img.ardmediathek.de/*',
            'https://beta.ardmediathek.de/*',
            'https://ardmediathek.de/*',
            'https://api.ardmediathek.de/*',
            'https://www.ardmediathek.de/*',
            'http://play.arkena.com/*',
            'https://support.arkena.com/*',
            'http://video.arkena.com/*',
            'https://video.qbrick.com/*',
            'https://video.arnes.si/*',
            'https://api.arte.tv/*',
            'https://www.arte.tv/*',
            'https://www.asiancrush.com/*',
            'https://www.yuyutv.com/*',
            'https://www.midnightpulp.com/*',
            'https://www.cocoro.tv/*',
            'https://www.retrocrush.tv/*',
            'https://www.atresplayer.com/*',
            'https://api.atresplayer.com/*',
            'https://account.atresmedia.com/*',
            'http://techchannel.att.com/*',
            'http://atv.at/*',
            'https://www.audi-mediacenter.com/*',
            'https://www.audimedia.tv/*',
            'https://audioboom.com/*',
            'http://www.audiomack.com/*',
            'http://www.dcndigital.ae/*',
            'http://dcndigital.ae/*',
            'http://admin.mangomolo.com/*',
            'http://awaan.ae/*',
            'http://docs.aws.amazon.com/*',
            'https://www.telezueri.ch/*',
            'https://www.telebaern.tv/*',
            'http://v.baidu.com/*',
            'http://app.video.baidu.com/*',
            'https://www.b-ch.com/*',
            'https://pbifcd.b-ch.com/*',
            'http://youtube-dl.bandcamp.com/*',
            'http://benprunty.bandcamp.com/*',
            'https://relapsealumni.bandcamp.com/*',
            'http://blazo.bandcamp.com/*',
            'http://nightbringer.bandcamp.com/*',
            'http://dotscale.bandcamp.com/*',
            'https://jstrecords.bandcamp.com/*',
            'https://insulters.bandcamp.com/*',
            'https://bandcamp.com/*',
            'https://account.bbc.com/*',
            'https://open.live.bbc.co.uk/*',
            'https://www.bbc.com/*',
            'https://graph.ibl.api.bbc.co.uk/*',
            'https://www.bbc.co.uk/*',
            'http://ibl.api.bbc.co.uk/*',
            'http://www.bbc.co.uk/*',
            'https://beatport.com/*',
            'http://beeg.com/*',
            'https://beeg.com/*',
            'https://beeg.porn/*',
            'http://www.behindkink.com/*',
            'https://www.bnnbloomberg.ca/*',
            'http://www.thecomedynetwork.ca/*',
            'http://www.tsn.ca/*',
            'http://www.bnn.ca/*',
            'http://www.much.com/*',
            'http://www.ctv.ca/*',
            'http://www.etalk.ca/*',
            'https://www.cp24.com/*',
            'http://www.bet.com/*',
            'https://player.bfi.org.uk/*',
            'https://www.bfmtv.com/*',
            'https://www.bibeltv.de/*',
            'http://www.bigflix.com/*',
            'http://www.bild.de/*',
            'http://www.bilibili.com/*',
            'https://secure\.bilibili\.com/*',
            'http://interface.bilibili.com/*',
            'https://www.bilibili.com/*',
            'http://player.bilibili.com/*',
            'http://www.bilibili.tv/*',
            'http://www.biobiochile.cl/*',
            'http://tv.biobiochile.cl/*',
            'https://biqle.ru/*',
            'http://biqle.org/*',
            'https://api.vk.com/*',
            'https://www.bitchute.com/*',
            'http://api.bleacherreport.com/*',
            'https://vine.co/*',
            'http://bleacherreport.com/*',
            'https://www.bloomberg.com/*',
            'http://www.bloomberg.com/*',
            'http://p.bokecc.com/*',
            'http://union.bokecc.com/*',
            'https://de.bongacams.com/*',
            'https://cn.bongacams.com/*',
            'http://www.bostonglobe.com/*',
            'https://www.bostonglobe.com/*',
            'https://mlssoccer.app.box.com/*',
            'https://app.box.com/*',
            'https://api.box.com/*',
            'http://www.bpb.de/*',
            'https://www.br-klassik.de/*',
            'http://www.br.de/*',
            'http://yt-dl.org/*',
            'https://www.br.de/*',
            'https://proxy-base.master.mango.express/*',
            'https://www.bravotv.com/*',
            'http://www.bravotv.com/*',
            'https://www.oxygen.com/*',
            'http://www.break.com/*',
            'http://www.8tv.cat/*',
            'http://medianetwork.oracle.com/*',
            'http://mashable.com/*',
            'http://national.ballet.ca/*',
            'http://www.redbull.com/*',
            'http://support.brightcove.com/*',
            'http://www.un.org/*',
            'https://link.brightcove.com/*',
            'http://www.popcornflix.com/*',
            'http://www8.hp.com/*',
            'http://c.brightcove.com/*',
            'http://www.ktvu.com/*',
            'http://link.brightcove.com/*',
            'https://players.brightcove.net/*',
            'http://docs.brightcove.com/*',
            'https://support.brightcove.com/*',
            'https://edge.api.brightcove.com/*',
            'http://uk.businessinsider.com/*',
            'https://www.businessinsider.nl/*',
            'http://www.businessinsider.com/*',
            'http://www.buzzfeed.com/*',
            'http://www.byutv.org/*',
            'https://www.byutv.org/*',
            'https://api.byutv.org/*',
            'http://www.56.com/*',
            'http://vxml.56.com/*',
            'http://www.camdemy.com/*',
            'https://www.cammodels.com/*',
            'https://camtube.co/*',
            'https://api.camtube.co/*',
            'http://archives-canalc2.u-strasbg.fr/*',
            'http://www.canalc2.tv/*',
            'http://service.canal-plus.com/*',
            'https://www.mycanal.fr/*',
            'http://www.piwiplus.fr/*',
            'http://player.canalplus.fr/*',
            'https://media-services-public.vrt.be/*',
            'http://www.canvas.be/*',
            'https://www.een.be/*',
            'https://www.canvas.be/*',
            'https://token.vrt.be/*',
            'https://www.vrt.be/*',
            'https://dagelijksekost.een.be/*',
            'https://mediazone.vrt.be/*',
            'http://video1.carambatv.ru/*',
            'http://carambatv.ru/*',
            'https://www.cartoonnetwork.com/*',
            'http://www.cbc.ca/*',
            'http://www.clearleap.com/*',
            'https://api.loginradius.com/*',
            'https://cloud-api.loginradius.com/*',
            'https://api-cbc.cloud.clearleap.com/*',
            'http://watch.cbc.ca/*',
            'https://gem.cbc.ca/*',
            'https://olympics.cbc.ca/*',
            'http://www.cbs.com/*',
            'http://colbertlateshow.com/*',
            'http://www.colbertlateshow.com/*',
            'https://www.paramountplus.com/*',
            'http://can.cbs.com/*',
            'http://www.cnet.com/*',
            'http://www.zdnet.com/*',
            'http://newyork.cbslocal.com/*',
            'http://losangeles.cbslocal.com/*',
            'http://cleveland.cbslocal.com/*',
            'https://www.cbsnews.com/*',
            'http://www.cbsnews.com/*',
            'http://feeds.cbsn.cbsnews.com/*',
            'https://embed.247sports.com/*',
            'https://www.cbssports.com/*',
            'https://247sports.com/*',
            'https://media.ccc.de/*',
            'http://www.ccma.cat/*',
            'http://dinamics.ccma.cat/*',
            'http://sports.cntv.cn/*',
            'http://cctv.cntv.cn/*',
            'http://www.ncpa-classic.com/*',
            'http://ent.cntv.cn/*',
            'http://english.cntv.cn/*',
            'http://tv.cctv.com/*',
            'http://tv.cntv.cn/*',
            'http://vdn.apps.cntv.cn/*',
            'http://www.cda.pl/*',
            'http://ebd.cda.pl/*',
            'https://www.cda.pl/*',
            'https://www.ceskatelevize.cz/*',
            'http://www.ceskatelevize.cz/*',
            'http://channel9.msdn.com/*',
            'https://channel9.msdn.com/*',
            'https://charlierose.com/*',
            'https://www.chaturbate.com/*',
            'https://en.chaturbate.com/*',
            'https://chaturbate.com/*',
            'https://roomimg.stream.highwebmedia.com/*',
            'http://www.chilloutzone.net/*',
            'http://vimeo.com/*',
            'https://chirb.it/*',
            'http://chirbit.com/*',
            'http://player.cinchcast.com/*',
            'http://www.blogtalkradio.com/*',
            'http://search.yahoo.com/*',
            'http://developer.longtailvideo.com/*',
            'https://www.cinemax.com/*',
            'https://events.rainfocus.com/*',
            'https://ciscolive.cisco.com/*',
            'https://www.ciscolive.com/*',
            'http://cjsw.com/*',
            'http://www.cliphunter.com/*',
            'https://www.clippituser.tv/*',
            'http://www.clip.rs/*',
            'http://www.clipsyndicate.com/*',
            'http://chic.clipsyndicate.com/*',
            'http://eplayer.clipsyndicate.com/*',
            'http://closertotruth.com/*',
            'https://embed.cloudflarestream.com/*',
            'https://watch.cloudflarestream.com/*',
            'https://cloudflarestream.com/*',
            'https://embed.videodelivery.net/*',
            'http://www.cloudy.ec/*',
            'https://www.cloudy.ec/*',
            'http://img\.clubic\.com/*',
            'http://www.clubic.com/*',
            'http://player.m6web.fr/*',
            'https://clyp.it/*',
            'https://api.clyp.it/*',
            'http://www.cmt.com/*',
            'http://media.mtvnservices.com/*',
            'https://www.cnbc.com/*',
            'https://webql-redesign.cnbcfm.com/*',
            'http://video.cnbc.com/*',
            'http://edition.cnn.com/*',
            'http://pmd.cdn.turner.com/*',
            'http://money.cnn.com/*',
            'http://ht3.cdn.turner.com/*',
            'http://reliablesources.blogs.cnn.com/*',
            'http://www.cnn.com/*',
            'http://cnn.com/*',
            'http://comedycentral.com/*',
            'http://www.cc.com/*',
            'https://www.cc.com/*',
            'https://www.comedycentral.tv/*',
            'http://feeds.mtvnservices.com/*',
            'https://bugs.python.org/*',
            'http://msdn.microsoft.com/*',
            'http://www.rtalabel.org/*',
            'http://www.tjg-designs.com/*',
            'http://schema.org/*',
            'http://ns.adobe.com/*',
            'http://matchtv.ru/*',
            'https://tools.ietf.org/*',
            'http://www.vidio.com/*',
            'http://xspf.org/*',
            'http://static.streamone.nl/*',
            'http://standards.iso.org/*',
            'https://en.wikipedia.org/*',
            'http://www.svtplay.se/*',
            'https://play.arkena.com/*',
            'https://www.youtube.com/*',
            'https://www.seznam.cz/*',
            'https://msdn.microsoft.com/*',
            'https://www.ampproject.org/*',
            'https://delight-vr.com/*',
            'http://www.porntrex.com/*',
            'https://learn.akamai.com/*',
            'https://new.vk.com/*',
            'https://learning.oreilly.com/*',
            'http://video.wired.com/*',
            'http://video.gq.com/*',
            'http://player-backend.cnevids.com/*',
            'http://player.cnevids.com/*',
            'https://player.cnevids.com/*',
            'http://metax.contv.live.junctiontv.net/*',
            'https://www.contv.com/*',
            'http://www.hgtv.ca/*',
            'http://www.foodnetwork.ca/*',
            'http://etcanada.com/*',
            'http://www.history.ca/*',
            'http://www.showcase.ca/*',
            'http://www.bigbrothercanada.ca/*',
            'https://www.bigbrothercanada.ca/*',
            'https://www.seriesplus.com/*',
            'https://www.disneychannel.ca/*',
            'https://globalcontent.corusappservices.com/*',
            'http://c-cdn.coub.com/*',
            'http://coub.com/*',
            'http://www.cracked.com/*',
            'https://www.crackle.com/*',
            'https://www.sonycrackle.com/*',
            'https://web-api-us.crackle.com/*',
            'https://embed.crooksandliars.com/*',
            'http://embed.crooksandliars.com/*',
            'http://www.crunchyroll.fr/*',
            'https://www.crunchyroll.com/*',
			'https://xhamster.com/*',
			'https://xvideos.com/*',
			'https://redtube.com/*',
			'https://pornhub.com/*',
			'https://spankbang.com/*',
			'https://youporn.com/*',
			'https://incestflix.com/*',
			'https://pornbimbo.com/*',
			'https://rule43.com/*',
			'https://freeuseporn.com/*',
			'https://tubesafari.com/*',
			'https://www.freeuseporn.org/*',
			'https://incestflix.com/*',
			'https://freeusex.com/*',
			'https://www.xhamster.com/*',
			'https://www.xvideos.com/*',
			'https://www.redtube.com/*',
			'https://www.pornhub.com/*',
			'https://www.spankbang.com/*',
			'https://www.youporn.com/*',
			'https://www.incestflix.com/*',
			'https://www.pornbimbo.com/*',
			'https://www.rule43.com/*',
			'https://www.freeuseporn.com/*',
			'https://www.tubesafari.com/*',
			'https://www.freeuseporn.org/*',
			'https://www.incestflix.com/*',
			'https://www.freeusex.com/*',
            'http://www.crunchyroll.com/*',
            'https://www.c-span.org/*',
            'http://www.c-span.org/*',
            'http://news.cts.com.tw/*',
            'https://www.ctv.ca/*',
            'http://vancouverisland.ctvnews.ca/*',
            'http://www.ctvnews.ca/*',
            'http://www.cultureunplugged.com/*',
            'https://api.curiositystream.com/*',
            'https://app.curiositystream.com/*',
            'https://curiositystream.com/*',
            'http://www.cwseed.com/*',
            'http://cwtvpr.com/*',
            'http://cwtv.com/*',
            'http://images.cwtv.com/*',
            'http://link.theplatform.com/*',
            'http://www.dailymail.co.uk/*',
            'https://graphql.api.dailymotion.com/*',
            'https://www.lequipe.fr/*',
            'https://developer.dailymotion.com/*',
            'https://www.dailymotion.com/*',
            'http://tv.kakao.com/*',
            'http://videofarm.daum.net/*',
            'http://tvpot.daum.net/*',
            'http://m.tvpot.daum.net/*',
            'https://www.dagbladet.no/*',
            'http://www.dctp.tv/*',
            'http://dctp-ivms2-restapi.s3.amazonaws.com/*',
            'http://www.deezer.com/*',
            'http://www.defense.gouv.fr/*',
            'http://static.videos.gouv.fr/*',
            'http://www.democracynow.org/*',
            'http://www.dhm.de/*',
            'http://digg.com/*',
            'https://www.ultimedia.com/*',
            'https://www.digiteka.net/*',
            'http://www.ultimedia.com/*',
            'https://www.investigationdiscovery.com/*',
            'https://go.discovery.com/*',
            'https://www.sciencechannel.com/*',
            'https://api.discovery.com/*',
            'https://www.discovery.com/*',
            'https://www.discoverygo.com/*',
            'https://www.tlc.de/*',
            'https://www.dmax.de/*',
            'https://www.dplay.co.uk/*',
            'https://tlc.de/*',
            'http://www.discoveryvr.com/*',
            'http://video.disney.com/*',
            'http://videos.disneylatino.com/*',
            'http://video.en.disneyme.com/*',
            'http://video.disneyturkiye.com.tr/*',
            'http://www.starwars.com/*',
            'http://spiderman.marvelkids.com/*',
            'http://disneyjunior.en.disneyme.com/*',
            'http://disneychannel.de/*',
            'http://disneyjunior.disney.com/*',
            'http://gdcvault.com/*',
            'http://sevt.dispeak.com/*',
            'https://gdcvault.com/*',
            'https://sevt.dispeak.com/*',
            'http://www.gdcvault.com/*',
            'http://events.digitallyspeaking.com/*',
            'http://evt.dispeak.com/*',
            'http://s3-2u.digitallyspeaking.com/*',
            'https://dlive.tv/*',
            'https://graphigo.prd.dlive.tv/*',
            'https://live.prd.dlive.tv/*',
            'https://dotsub.com/*',
            'http://www.douyutv.com/*',
            'http://www.douyu.com/*',
            'http://m.douyu.com/*',
            'http://coapi.douyucdn.cn/*',
            'https://v.douyu.com/*',
            'https://vmobile.douyu.com/*',
            'https://www.dplay.se/*',
            'http://www.dplay.dk/*',
            'https://www.dplay.no/*',
            'http://it.dplay.com/*',
            'https://es.dplay.com/*',
            'https://www.dplay.fi/*',
            'https://www.dplay.jp/*',
            'https://www.discoveryplus.se/*',
            'https://www.discoveryplus.dk/*',
            'https://www.discoveryplus.no/*',
            'https://www.discoveryplus.it/*',
            'https://www.discoveryplus.es/*',
            'https://www.discoveryplus.fi/*',
            'https://www.discoveryplus.com/*',
            'https://de.hgtv.com/*',
            'http://www.dr.dk/*',
            'https://www.zdf.de/*',
            'https://www.3sat.de/*',
            'https://www.dropbox.com/*',
            'http://m.drtuber.com/*',
            'http://www.drtuber.com/*',
            'https://dr-massive.com/*',
            'https://www.dr.dk/*',
            'https://d.tube/*',
            'https://api.steemit.com/*',
            'https://video.dtube.top/*',
            'https://www.dumpert.nl/*',
            'http://legacy.dumpert.nl/*',
            'http://api-live.dumpert.nl/*',
            'http://video.aktualne.cz/*',
            'https://video.aktualne.cz/*',
            'http://tv-download.dw.de/*',
            'http://www.dw.com/*',
            'http://lenta.ru/*',
            'http://muz-tv.ru/*',
            'https://tvrain.ru/*',
            'http://dultonmedia.github.io/*',
            'http://lentaru.media.eagleplatform.com/*',
            'http://www.ebaumsworld.com/*',
            'http://www.echo.msk.ru/*',
            'https://egghead.io/*',
            'https://app.egghead.io/*',
            'http://www.ehow.com/*',
            'http://8tracks.com/*',
            'https://einthusan.tv/*',
            'https://einthusan.com/*',
            'https://einthusan.ca/*',
            'http://www.eitb.tv/*',
            'http://mam.eitb.eus/*',
            'https://api-prod\.ellentube\.com/*',
            'https://www.ellentube.com/*',
            'https://api-prod.ellentube.com/*',
            'http://blogs.elpais.com/*',
            'http://elcomidista.elpais.com/*',
            'http://epv.elpais.com/*',
            'http://elpais.com/*',
            'https://cdn.embedly.com/*',
            'https://www.engadget.com/*',
            'https://www.eporner.com/*',
            'http://www.eroprofile.com/*',
            'http://escapistmagazine.com/*',
            'https://v1.escapistmagazine.com/*',
            'http://www.escapistmagazine.com/*',
            'https://broadband.espn.go.com/*',
            'http://nonredline.sports.espn.go.com/*',
            'https://cdn.espn.go.com/*',
            'https://espn.go.com/*',
            'http://www.espnfc.us/*',
            'http://www.espnfc.com/*',
            'http://www.espn.com/*',
            'http://api-app.espn.com/*',
            'http://espn.go.com/*',
            'http://fivethirtyeight.com/*',
            'https://video.esri.com/*',
            'http://ec.europa.eu/*',
            'http://www.expotv.com/*',
            'http://client.expotv.com/*',
            'https://www.expressen.se/*',
            'https://www.di.se/*',
            'http://www.extremetube.com/*',
            'https://www.eyedo.tv/*',
            'http://live.eyedo.net:1935/*',
            'http://schemas.datacontract.org/*',
            'http://eyedo.tv/*',
            'http://rrr.sz.xlcdn.com/*',
            'https://zh-hk.facebook.com/*',
            'https://www.facebookcorewwwi.onion/*',
            'https://m.facebook.com/*',
            'https://developers.facebook.com/*',
            'https://www.facebook.com/*',
            'http://www.faz.net/*',
            'https://secure.id.fc2.com/*',
            'http://id.fc2.com/*',
            'http://video.fc2.com/*',
            'http://fc-zenit.ru/*',
            'http://player.fc-zenit.ru/*',
            'https://www.filmon.com/*',
            'http://www.filmon.com/*',
            'http://static.filmon.com/*',
            'http://www.filmweb.no/*',
            'https://www.filmweb.no/*',
            'http://www.1tv.ru/*',
            'http://static.1tv.ru/*',
            'http://www.engadget.com/*',
            'http://pshared.5min.com/*',
            'http://on.aol.com/*',
            'http://embed.5min.com/*',
            'http://delivery.vidible.tv/*',
            'https://www.5-tv.ru/*',
            'http://5-tv.ru/*',
            'http://www.5-tv.ru/*',
            'http://www.flickr.com/*',
            'https://api.flickr.com/*',
            'https://help.yahoo.com/*',
            'https://www.flickr.com/*',
            'http://www.ft.dk/*',
            'http://ft\.arkena\.tv/*',
            'http://footyroom.com/*',
            'https://www.formula1.com/*',
            'http://players.brightcove.net/*',
            'https://www.4tube.com/*',
            'http://www.4tube.com/*',
            'http://m.4tube.com/*',
            'https://www.fux.com/*',
            'https://www.porntube.com/*',
            'https://m.porntube.com/*',
            'https://www.pornerbros.com/*',
            'https://m.pornerbros.com/*',
            'https://www.fox.com/*',
            'https://api2.fox.com/*',
            'https://www.fox9.com/*',
            'http://video.foxbusiness.com/*',
            'http://video.insider.foxnews.com/*',
            'http://www.foxnews.com/*',
            'http://insider.foxnews.com/*',
            'http://video.foxnews.com/*',
            'http://www.foxsports.com/*',
            'https://feed.theplatform.com/*',
            'http://www.franceculture.fr/*',
            'https://www.franceculture.fr/*',
            'https://schema.org/*',
            'https://www.franceinter.fr/*',
            'http://videos.francetv.fr/*',
            'http://geo.francetv.fr/*',
            'https://player.webservices.francetelevisions.fr/*',
            'https://github.com/*',
            'https://sivideo.webservices.francetelevisions.fr/*',
            'https://www.france.tv/*',
            'http://abc.net.au/*',
            'http://CLICK1.NET/*',
            'http://myEVTV.com/*',
            'http://adobe.com/*',
            'http://history.com/*',
            'http://aetv.com/*',
            'http://mylifetime.com/*',
            'http://lifetimemovieclub.com/*',
            'http://fyi.tv/*',
            'http://historyvault.com/*',
            'http://biography.com/*',
            'http://History.com/*',
            'http://afreecatv.com/*',
            'http://img.afreecatv.com/*',
            'http://aol.com/*',
            'http://archive.org/*',
            'http://s-config-prod.api.cdn.arcpublishing.com/*',
            'http://s.arcpublishing.com/*',
            'http://s-prod-cdn.video-api.arcpublishing.com/*',
            'http://vnd.ms/*',
            'http://video.arnes.si/*',
            'http://retrocrush.tv/*',
            'http://cocoro.tv/*',
            'http://self.id/*',
            'http://e.id/*',
            'http://www.bbc.com/*',
            'http://bbc.co.uk/*',
            'http://Bild.de/*',
            'http://bangumi.bilibili.com/*',
            'http://cms.bleacherreport.com/*',
            'http://vid.bleacherreport.com/*',
            'http://ooyala.com/*',
            'http://youtube.com/*',
            'http://vine.co/*',
            'http://akamaihd.net/*',
            'http://brightcove.com/*',
            'http://bcove.me/*',
            'http://56.com/*',
            'http://api.camtube.co/*',
            'http://camwithher.tv/*',
            'http://canalc2.tv/*',
            'http://mycanal.fr/*',
            'http://piwiplus.fr/*',
            'http://canvas.be/*',
            'http://een.be/*',
            'http://VrtNU.be/*',
            'http://dagelijksekost.een.be/*',
            'http://feed.theplatform.com/*',
            'http://tpfeed.cbc.ca/*',
            'http://cbc.ca/*',
            'http://Curb.tv/*',
            'http://media.ccc.de/*',
            'http://2cda.pl/*',
            'http://3cda.pl/*',
            'http://cda.pl/*',
            'http://makingoficons.com/*',
            'http://chirb.it/*',
            'http://bytehighway.net/*',
            'http://videodelivery.net/*',
            'http://cloudy.ec/*',
            'http://cmt.com/*',
            'http://cnn-vh.akamaihd.net/*',
            'http://intl.mtvi.com/*',
            'http://web.cc.tv/*',
            'http://blocklist.rkn.gov.ru/*',
            'http://RTMPMediaProvider.as/*',
            'http://www.youtube.com/*',
            'http://cp44293.edgefcs.net/*',
            'http://edge.live.hitbox.tv/*',
            'http://kentro.kaist.ac.kr/*',
            'http://fplive.net/*',
            'http://v.lvlt.crcdn.net/*',
            'http://senate.gov/*',
            'http://www.dailymotion.com/*',
            'http://View.do/*',
            'http://daum.net/*',
            'http://cdn-segments.dctp.tv/*',
            'http://completed-media.s3.amazonaws.com/*',
            'http://cdn-media.dctp.tv/*',
            'http://defense.gouv.fr/*',
            'http://tv.dfb.de/*',
            'http://show.name/*',
            'http://dplay.co.uk/*',
            'http://sonic-eu1-prod.disco-api.com/*',
            'http://dotsub.com/*',
            'http://eu2-prod.disco-api.com/*',
            'http://us1-prod-direct.discoveryplus.com/*',
            'http://eu1-prod.disco-api.com/*',
            'http://tv-od.dw.de/*',
            'http://media.clipyou.ru/*',
            'http://tvrainru.media.eagleplatform.com/*',
            'http://egghead.io/*',
            'http://eitb.tv/*',
            'http://www.eporner.com/*',
            'http://4shared.com/*',
            'http://instagram.com/*',
            'http://facebook.com/*',
            'http://m.facebook.com/*',
            'http://www.facebook.com/*',
            'http://Gov.sg/*',
            'http://faz.net/*',
            'http://dl.org/*',
            'http://ServerConst.as/*',
            'http://balancer-vod.1tv.ru/*',
            'http://ft.dk/*',
            'http://token.4tube.com/*',
            'http://token.fux.com/*',
            'http://tkn.porntube.com/*',
            'http://token.pornerbros.com/*',
            'http://Foxgay.com/*',
            'http://foxgay.com/*',
            'http://hdfauthftv-a.akamaihd.net/*',
            'http://hdfauth.francetv.fr/*',
            'http://live.francetv.fr/*'					
        ],
        contexts: ['link'],
    });
});

chrome.contextMenus.onClicked.addListener(function(item, tab) {
    chrome.storage.sync.get(['metube'], function(data) {
        if (data === undefined || !data.hasOwnProperty('metube') || data.metube === "") {
            openTab(chrome.runtime.getURL('options.html'), tab);
            return
        }

        fetch(data.metube + "/add", {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "quality": "best",
                    "url": item.linkUrl
                })
            })
            .then(function(res) {
                if (res.ok === true && res.status === 200) {
                    return res.json();
                }
                // todo fix it
                alert("error :: code " + res.status);
            })
            .then(function(result) {
                if (result.status === "ok") {
                    openTab(data.metube, tab);
                } else {
                    // todo fix it
                    alert("error :: " + json);
                }
            })
            .catch(function(res) {
                alert("error :: " + res);
            })
    });
});

chrome.action.onClicked.addListener(function(tab) {
    chrome.storage.sync.get(['metube'], function(data) {
        if (data === undefined || !data.hasOwnProperty('metube') || data.metube === "") {
            openTab(chrome.runtime.getURL('options.html'), tab);
            return
        }

        openTab(data.metube, tab);
    });
});

function openTab(url, currentTab) {
    chrome.tabs.query({
        url: url + "/*"
    }, function(tabs) {
        if (tabs.length !== 0) {
            chrome.tabs.update(tabs[0].id, {
                'active': true
            }, () => {});
        } else {
            chrome.tabs.create({
                url: url,
                index: currentTab.index + 1
            });
        }
    });
}
